#!/system/bin/sh
curdate=`date +"%d%m%Y"`
pl=`ls /dev/block/platform`
for p in $pl
do
	platform=$p
	break
done
dd if=/dev/block/platform/$platform/by-name/TA of=/data/local/tmp/tabackup/TA-${curdate}.img &> /dev/null
chmod 777 /data/local/tmp/tabackup/TA-${curdate}.img
chown shell:shell /data/local/tmp/tabackup/TA-${curdate}.img
md5orig=`md5 /dev/block/platform/$platform/by-name/TA`
md5copy=`md5 /data/local/tmp/tabackup/TA-${curdate}.img`
match=0
for md5 in $md5orig
do
	for md5_2 in $md5copy
	do
		if [ "$md5" = "$md5_2" ]; then
			match=1
		fi
		break
	done
	break
done

echo ""
if [ $match -eq 0 ]; then
	echo "Error copying TA.img"
else
	echo "TA.img copied successfully"
fi
